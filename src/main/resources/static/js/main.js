/* =========================
   Translations
========================= */
const translations = {
    uz: {
        'logo': 'Imomjon.dev',
        'nav-about': 'Men haqimda',
        'nav-skills': 'Ko‘nikmalar',
        'nav-projects': 'Loyihalar',
        'nav-experience': 'Ish tajribasi',
        'nav-education': 'Ta’lim',
        'nav-contact': 'Aloqa',
        'download-cv': 'CV yuklab olish',

        'hero-name': 'Imomjon Risqiboyev',
        'hero-title': 'Java Backend Developer',
        'hero-description': 'Tajribali Java Backend Developer. Spring Boot, REST API va PostgreSQL asosida ishonchli backend tizimlar yarataman. Real loyihalarda ishlaganman va kod sifatiga katta e’tibor beraman.',
        'contact-me': 'Bog‘lanish',

        'about-title': 'Men haqimda',
        'about-text1': 'Men Java Backend Developer sifatida Spring Boot asosida REST API lar, ma’lumotlar bazasi dizayni va integratsiyalar bilan ishlayman. Loyihalarda arxitektura, toza kod va barqarorlikka e’tibor beraman.',
        'about-text2': 'Real biznes vazifalarni texnik yechimga aylantirish, performance va xavfsizlik kabi jihatlarni hisobga olish menga yoqadi. Maqsadim — kuchli software engineer bo‘lib, foydali va ta’sirli mahsulotlarga hissa qo‘shish.',
        'about-metric1-label': 'Yo‘nalish',
        'about-metric1-value': 'Backend & API',
        'about-metric2-label': 'Stack',
        'about-metric2-value': 'Java / Spring',

        'location': 'Toshkent, O‘zbekiston',

        'skills-title': 'Ko‘nikmalar va texnologiyalar',
        'core-tech': 'Asosiy texnologiyalar',
        'databases': 'Ma’lumotlar bazalari',
        'apis-tools': 'API va vositalar',
        'devops-other': 'DevOps va boshqalar',

        'projects-title': 'Loyihalar',
        'project1-title': 'E-commerce Web Ilovasi',
        'project1-desc': 'To‘liq e-commerce platformasi: ro‘yxatdan o‘tish, login, mahsulotlar ro‘yxati va buyurtma berish.',
        'project2-title': 'IPE School — Management System',
        'project2-desc': 'O‘quv markaz uchun ichki boshqaruv tizimi: talabalar, o‘qituvchilar, kurslar va to‘lovlarni yuritish.',
        'project3-title': 'Trello Kloni',
        'project3-desc': 'Trello-ga o‘xshash task management ilovasi: MVC arxitekturasi va CRUD funksiyalar bilan.',
        'view-project': 'Loyihani ko‘rish',

        'experience-title': 'Ish tajribasi',
        'exp1-role': 'Backend Developer',
        'exp1-company': 'IPE School',
        'exp1-desc': 'O‘quv markazi uchun ichki boshqaruv tizimini ishlab chiqish: REST API, ma’lumotlar bazasi, rollar va asosiy biznes jarayonlar.',
        'exp1-date': '2024 - 2025',

        'exp2-role': 'Freelance Backend Developer',
        'exp2-company': 'Shift Academy',
        'exp2-desc': 'Freelance formatda backend vazifalar: API lar, integratsiyalar, database bilan ishlash va mavjud loyihalarni takomillashtirish.',
        'exp2-date': '2025 - 2026',

        'education-title': 'Ta’lim',
        'edu1-title': 'Kompyuter ilmlari va dasturlash texnologiyalari bakalavri',
        'edu1-school': 'O‘zbekiston Milliy Universiteti',
        'edu1-details': 'Amaliy matematika va intellektual texnologiyalar fakulteti (masofaviy ta’lim)',
        'edu2-title': 'Java Backend Development',
        'edu2-desc': 'Java Core, OOP, Spring Boot, REST API, PostgreSQL va amaliy loyihalar asosidagi backend yo‘nalishi.',

        'contact-title': 'Bog‘lanish',
        'contact-desc': 'Hamkorlik, ish takliflari yoki loyiha bo‘yicha savollar bo‘lsa — bemalol yozing.',
        'footer-rights': 'Barcha huquqlar himoyalangan.'
    },

    en: {
        'logo': 'Imomjon.dev',
        'nav-about': 'About',
        'nav-skills': 'Skills',
        'nav-projects': 'Projects',
        'nav-experience': 'Experience',
        'nav-education': 'Education',
        'nav-contact': 'Contact',
        'download-cv': 'Download CV',

        'hero-name': 'Imomjon Risqiboyev',
        'hero-title': 'Java Backend Developer',
        'hero-description': 'Experienced Java Backend Developer. I build reliable backend systems with Spring Boot, REST APIs and PostgreSQL. I’ve worked on real projects and value clean, maintainable code.',
        'contact-me': 'Contact Me',

        'about-title': 'About Me',
        'about-text1': 'As a Java Backend Developer, I work with Spring Boot-based REST APIs, database design and integrations. I focus on architecture, clean code and stability.',
        'about-text2': 'I enjoy turning real business needs into technical solutions and considering performance and security. My goal is to grow as a strong software engineer and contribute to impactful products.',
        'about-metric1-label': 'Focus',
        'about-metric1-value': 'Backend & API',
        'about-metric2-label': 'Stack',
        'about-metric2-value': 'Java / Spring',

        'location': 'Tashkent, Uzbekistan',

        'skills-title': 'Skills & Technologies',
        'core-tech': 'Core Technologies',
        'databases': 'Databases',
        'apis-tools': 'APIs & Tools',
        'devops-other': 'DevOps & Other',

        'projects-title': 'Projects',
        'project1-title': 'E-commerce Web Application',
        'project1-desc': 'Complete e-commerce platform: registration, login, product listing and ordering.',
        'project2-title': 'IPE School — Management System',
        'project2-desc': 'Internal management system for an education center: students, teachers, courses and payments.',
        'project3-title': 'Trello Clone',
        'project3-desc': 'Trello-like task management app with MVC architecture and CRUD features.',
        'view-project': 'View Project',

        'experience-title': 'Experience',
        'exp1-role': 'Backend Developer',
        'exp1-company': 'IPE School',
        'exp1-desc': 'Built an internal management system: REST APIs, database, roles and key business flows.',
        'exp1-date': '2024 - 2025',

        'exp2-role': 'Freelance Backend Developer',
        'exp2-company': 'Shift Academy',
        'exp2-desc': 'Freelance backend work: APIs, integrations, database tasks and improving existing systems.',
        'exp2-date': '2025 - 2026',

        'education-title': 'Education',
        'edu1-title': 'Bachelor of Computer Science and Programming Technologies',
        'edu1-school': 'National University of Uzbekistan',
        'edu1-details': 'Faculty of Applied Mathematics and Intellectual Technologies (Distance learning)',
        'edu2-title': 'Java Backend Development',
        'edu2-desc': 'Backend track based on Java Core, OOP, Spring Boot, REST APIs, PostgreSQL and practical projects.',

        'contact-title': 'Get In Touch',
        'contact-desc': 'For collaboration, job offers, or project questions — feel free to message me.',
        'footer-rights': 'All rights reserved.'
    },

    ru: {
        'logo': 'Imomjon.dev',
        'nav-about': 'Обо мне',
        'nav-skills': 'Навыки',
        'nav-projects': 'Проекты',
        'nav-experience': 'Опыт',
        'nav-education': 'Образование',
        'nav-contact': 'Контакты',
        'download-cv': 'Скачать CV',

        'hero-name': 'Имомжон Рисқибойев',
        'hero-title': 'Java Backend Developer',
        'hero-description': 'Опытный Java Backend разработчик. Создаю надёжные backend-системы на Spring Boot, REST API и PostgreSQL. Работал над реальными проектами и ценю чистый, поддерживаемый код.',
        'contact-me': 'Связаться',

        'about-title': 'Обо мне',
        'about-text1': 'Как Java Backend разработчик я работаю с REST API на Spring Boot, проектированием баз данных и интеграциями. Делаю упор на архитектуру, чистый код и стабильность.',
        'about-text2': 'Мне нравится превращать бизнес-задачи в технические решения, учитывая производительность и безопасность. Цель — развиваться как сильный software engineer и участвовать в значимых продуктах.',
        'about-metric1-label': 'Фокус',
        'about-metric1-value': 'Backend & API',
        'about-metric2-label': 'Стек',
        'about-metric2-value': 'Java / Spring',

        'location': 'Ташкент, Узбекистан',

        'skills-title': 'Навыки и технологии',
        'core-tech': 'Основные технологии',
        'databases': 'Базы данных',
        'apis-tools': 'API и инструменты',
        'devops-other': 'DevOps и другое',

        'projects-title': 'Проекты',
        'project1-title': 'E-commerce веб-приложение',
        'project1-desc': 'Полная e-commerce платформа: регистрация, вход, каталог товаров и оформление заказов.',
        'project2-title': 'IPE School — Management System',
        'project2-desc': 'Внутренняя система управления учебным центром: студенты, преподаватели, курсы и платежи.',
        'project3-title': 'Клон Trello',
        'project3-desc': 'Task-management приложение в стиле Trello: MVC архитектура и CRUD функции.',
        'view-project': 'Открыть проект',

        'experience-title': 'Опыт работы',
        'exp1-role': 'Backend Developer',
        'exp1-company': 'IPE School',
        'exp1-desc': 'Разработка внутренней системы: REST API, база данных, роли и ключевые бизнес-процессы.',
        'exp1-date': '2024 - 2025',

        'exp2-role': 'Freelance Backend Developer',
        'exp2-company': 'Shift Academy',
        'exp2-desc': 'Фриланс-задачи по backend: API, интеграции, работа с базой данных и улучшение существующих систем.',
        'exp2-date': '2025 - 2026',

        'education-title': 'Образование',
        'edu1-title': 'Бакалавр: компьютерные науки и технологии программирования',
        'edu1-school': 'Национальный университет Узбекистана',
        'edu1-details': 'Факультет прикладной математики и интеллектуальных технологий (дистанционное обучение)',
        'edu2-title': 'Java Backend Development',
        'edu2-desc': 'Направление backend: Java Core, ООП, Spring Boot, REST API, PostgreSQL и практические проекты.',

        'contact-title': 'Контакты',
        'contact-desc': 'По сотрудничеству, предложениям о работе или вопросам по проектам — пишите.',
        'footer-rights': 'Все права защищены.'
    }
};

let currentLanguage = 'uz';

function applyTranslations(lang) {
    document.querySelectorAll('[data-key]').forEach(el => {
        const key = el.getAttribute('data-key');
        if (translations[lang]?.[key]) el.textContent = translations[lang][key];
    });
}

function changeLanguage(lang) {
    currentLanguage = lang;
    const currentLangEl = document.getElementById('currentLang');
    const dd = document.getElementById('languageDropdown');

    if (currentLangEl) currentLangEl.textContent = lang.toUpperCase();
    if (dd) dd.classList.remove('active');

    document.documentElement.lang = lang;
    applyTranslations(lang);
    localStorage.setItem('lang', lang);
}

/* =========================
   DOM Ready
========================= */
document.addEventListener('DOMContentLoaded', () => {
    // Theme init
    const html = document.documentElement;
    const darkModeToggle = document.getElementById('darkModeToggle');
    const savedTheme = localStorage.getItem('theme') || 'light';
    if (savedTheme === 'dark') html.classList.add('dark');

    if (darkModeToggle) {
        darkModeToggle.addEventListener('click', () => {
            html.classList.toggle('dark');
            localStorage.setItem('theme', html.classList.contains('dark') ? 'dark' : 'light');
        });
    }

    // Language dropdown open/close
    const languageBtn = document.getElementById('languageBtn');
    const languageDropdown = document.getElementById('languageDropdown');

    if (languageBtn && languageDropdown) {
        languageBtn.addEventListener('click', () => languageDropdown.classList.toggle('active'));

        document.addEventListener('click', (e) => {
            if (!e.target.closest('#languageBtn') && !e.target.closest('#languageDropdown')) {
                languageDropdown.classList.remove('active');
            }
        });

        // language item clicks
        document.querySelectorAll('.lang-item').forEach(btn => {
            btn.addEventListener('click', () => changeLanguage(btn.dataset.lang));
        });
    }

    // Mobile menu
    const mobileMenuBtn = document.getElementById('mobileMenuBtn');
    const mobileMenu = document.getElementById('mobileMenu');
    const closeMobileMenu = document.getElementById('closeMobileMenu');

    if (mobileMenuBtn && mobileMenu) mobileMenuBtn.addEventListener('click', () => mobileMenu.classList.add('active'));
    if (closeMobileMenu && mobileMenu) closeMobileMenu.addEventListener('click', () => mobileMenu.classList.remove('active'));

    if (mobileMenu) {
        mobileMenu.querySelectorAll('a[href^="#"]').forEach(link => {
            link.addEventListener('click', () => mobileMenu.classList.remove('active'));
        });
    }

    // Smooth scroll
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) target.scrollIntoView({ behavior: 'smooth', block: 'start' });
        });
    });

    // Fade in
    const observerOptions = { threshold: 0.1, rootMargin: '0px 0px -50px 0px' };
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => { if (entry.isIntersecting) entry.target.classList.add('visible'); });
    }, observerOptions);

    document.querySelectorAll('.fade-in').forEach(el => observer.observe(el));

    // Init language
    const savedLang = localStorage.getItem('lang') || 'uz';
    changeLanguage(savedLang);
});
